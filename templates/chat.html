{% extends "base.html" %}
{% block content %}
    <h2>Chat dengan {{ recipient.username }}</h2>
    <div class="chat-box">
        {% for message in messages %}
            {% if message.sender_id == current_user.id %}
                <div class="message sender-message">
                    <strong>Anda:</strong> {{ decrypt_message(message.encrypted_message, current_user.private_key) }}
                </div>
            {% else %}
                <div class="message">
                    <strong>{{ recipient.username }}:</strong> {{ decrypt_message(message.encrypted_message, current_user.private_key) }}
                </div>
            {% endif %}
        {% endfor %}
    </div>
    <form method="POST" action="{{ url_for('chat', recipient_id=recipient.id) }}">
        <textarea name="message" rows="4" cols="50" required></textarea><br>
        <input type="submit" value="Kirim Pesan Terenkripsi">
    </form>
    <p><a href="{{ url_for('dashboard') }}">Kembali ke Dashboard</a></p>
{% endblock %}